<style>
  
.x {
display: block;
position: absolute;
width: 32px;
height: 32px;
  color: {{ section.settings.button_color }};
right: 0;
top: 0;
transition: background-color .25s ease-in-out;
}
.x:hover {
  background-color: {{ section.settings.hover_bg_color }};
}
.x:before {
content: "";
position: absolute;
display: block;
margin: auto;
left: 0;
right: 0;
top: 0;
bottom: 0;
width: {{ section.settings.button_x_width | append: 'px' }};
height: 0;
border-top: 1px solid {{ section.settings.button_color }};
transform: rotate(45deg);
transform-origin: center;
}
.x:after {
content: "";
position: absolute;
display: block;
margin: auto;
left: 0;
right: 0;
top: 0;
bottom: 0;
  width: {{ section.settings.button_x_width | append: 'px' }};
height: 0;
  border-top: 1px solid {{ section.settings.button_color }};
transform: rotate(-45deg);
transform-origin: center;
} 
  
.promo_banner-close {
position: absolute;
top: 5px;
right: 5px;
display: inline-block;
overflow: visible;
  width: {{ section.settings.button_bg_width | append: 'px' }};
height: {{ section.settings.button_bg_height | append: 'px' }};
margin: 0;
padding: 0;
cursor: pointer;
text-decoration: none;
  color: {{ section.settings.button_color }};
content: "\00d7";
border: 0;
outline: 0;
  background-color: {{ section.settings.button_bg_color }};
border: none;
  border-radius: {{ section.settings.corner_radius | append: 'em' }};
z-index: 1000
}

.promo_banner .promo_banner-close:before {
font-family: Arial, "Helvetica CY", "Nimbus Sans L", sans-serif !important;
font-size: 20px;
line-height: 30px;
position: absolute;
top: 0;
left: 0;
display: block;
width: 35px;
text-align: center;
}

@media screen and (max-width: 789px) {
.header-position {
position: fixed;
width: 100%;
z-index: 9;
top: 0;
}

body.no-announcement-bar, body.promo_banner-show {
padding-top: 0;
}


#header.mobile_nav-fixed--true {
position: relative!important;
top: 0;
}
}
  
  @media screen and (max-width: 768px) {
    .announce-content {
      max-width: 90% !important;
      width: 80% !important;
      margin: 0 auto;
    }
    .top-announce {
      font-size: {{ section.settings.top_announce_size_mobile | append: 'px' }} !important;
    }
    .bottom-announce {
      font-size: {{ section.settings.bottom_announce_size_mobile |append: 'px' }} !important;
    }
    .footer-announce {
      font-size: {{ section.settings.footer_announce_size_mobile |append: 'px' }} !important;
    }
  }
  
  .announcement-bar {
    background-color: {{ section.settings.announcement_bar_color }};
    text-align: {{ section.settings.text_align }};   
    text-decoration: none;
  }  
  
  .top-announce {
    font-size: {{ section.settings.top_announce_size | append: 'px'}};
    font-weight: {{ section.settings.top_announce_weight}};    
    {%- if section.settings.text_align == 'left' -%}
    	padding-left: 45px;
    {%- endif -%} 
    {%- if section.settings.text_align == 'right' -%}
    	padding-right: 45px;
    {%- endif -%}
    color: {{ section.settings.top_announce_color }};
          }
  
  .bottom-announce {
            font-size: {{ section.settings.bottom_announce_size | append: 'px' }};
    		font-weight: {{ section.settings.bottom_announce_weight}};
    {%- if section.settings.text_align == 'left' -%}
    	padding-left: 45px;
    {%- endif -%} 
    {%- if section.settings.text_align == 'right' -%}
    	padding-right: 45px;
    {%- endif -%}
            color: {{ section.settings.bottom_announce_color }};
  }
  
  .footer-announce {
            font-size: {{ section.settings.footer_announce_size | append: 'px' }};
    		font-weight: {{ section.settings.footer_announce_weight}};
    {%- if section.settings.text_align == 'left' -%}
    	padding-left: 45px;
    {%- endif -%} 
    {%- if section.settings.text_align == 'right' -%}
    	padding-right: 45px;
    {%- endif -%}
            color: {{ section.settings.footer_announce_color }};
          }
  
</style>
         
{%- if section.settings.show_announcement -%}
  {%- if section.settings.home_page_only == false or template.name == 'index' -%}

	<div class="announcement-bar">
      {%- if section.settings.show_close_button == true -%}
          <div class="promo_banner promo_banner-close x" ></div>
          {%- endif-%}
      
      <div class="announce-content">      
	{%- if section.settings.top_announce != blank -%}        
        <div class="top-announce">
          
          {%- if section.settings.top_shipping_count == true -%}
          
	{% capture shipping_value %}{{ section.settings.free_shipping_threshold | times: 100 }}{% endcapture %}
		{% assign cart_total = cart.total_price %}
		{% assign shipping_value_left = shipping_value | minus: cart_total %}
		{% assign shipping_value_left_money = shipping_value_left | money %}
		{% capture free_not_qualified %}
        {{ section.settings.free_not_qualified | replace: '[price]', shipping_value_left_money }}
	{% endcapture %}
      
		{% assign free_qualified = section.settings.free_qualified %}
		{% assign free_shipping_threshold = section.settings.free_shipping_threshold | times: 100 | money %}
		{% assign top_announce = section.settings.top_announce | replace: '[price]', free_shipping_threshold %}
	  
        {% if cart.total_price > 0 %}
          {% assign top_announce = free_not_qualified %}
        {% endif %}
        {% if shipping_value_left <= 0 %}
          {% assign top_announce = free_qualified %}
        {% endif %}
          {{ top_announce }}
          
          {%- else -%}
          
          {{ section.settings.top_announce }}
          {%- endif -%}
        </div>
        {%- endif -%}
          
        {%- if section.settings.bottom_announce !=blank -%}
        <div class="bottom-announce">
          
          {%- if section.settings.bottom_shipping_count == true -%}
          
          {% capture shipping_value %}{{ section.settings.free_shipping_threshold | times: 100 }}{% endcapture %}
      {% assign cart_total = cart.total_price %}
      {% assign shipping_value_left = shipping_value | minus: cart_total %}
      {% assign shipping_value_left_money = shipping_value_left | money %}
      {% capture free_not_qualified %}
        {{ section.settings.free_not_qualified | replace: '[price]', shipping_value_left_money }}
      {% endcapture %}
      {% assign free_qualified = section.settings.free_qualified %}
          {% assign free_shipping_threshold = section.settings.free_shipping_threshold | times: 100 | money %}
      {% assign bottom_announce = section.settings.bottom_announce | replace: '[price]', free_shipping_threshold %}
	  
        {% if cart.total_price > 0 %}
          {% assign bottom_announce = free_not_qualified %}
        {% endif %}
        {% if shipping_value_left <= 0 %}
          {% assign bottom_announce = free_qualified %}
        {% endif %}
          
          {{ bottom_announce }}
          {%- else -%}
          
          {{ section.settings.bottom_announce }}
          {%- endif -%}
        </div>            
        {%- endif -%}
        
        {%- if section.settings.footer_announce !=blank -%}
        <div class="footer-announce">
          
          {%- if section.settings.footer_shipping_count == true -%}
          
          {% capture shipping_value %}{{ section.settings.free_shipping_threshold | times: 100 }}{% endcapture %}
      {% assign cart_total = cart.total_price %}
      {% assign shipping_value_left = shipping_value | minus: cart_total %}
      {% assign shipping_value_left_money = shipping_value_left | money %}
      {% capture free_not_qualified %}
        {{ section.settings.free_not_qualified | replace: '[price]', shipping_value_left_money }}
      {% endcapture %}
      {% assign free_qualified = section.settings.free_qualified %}
          {% assign free_shipping_threshold = section.settings.free_shipping_threshold | times: 100 | money %}
      {% assign footer_announce = section.settings.footer_announce | replace: '[price]', free_shipping_threshold %}
	  
        {% if cart.total_price > 0 %}
          {% assign footer_announce = free_not_qualified %}
        {% endif %}
        {% if shipping_value_left <= 0 %}
          {% assign footer_announce = free_qualified %}
        {% endif %}
          
          {{ footer_announce }}
          
          {%- else -%}
          {{section.settings.footer_announce }}
          {%- endif -%}
        </div>
        {%- endif -%}
</div>
</div>
{%- endif -%}
{%- endif -%}

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

{%- if section.settings.show_again == true -%}
<script>
$( document ).ready(function() {

if ($('.announcement-bar').length){

$( '.x' ).click(function() {
    $(".announcement-bar").remove();
    $("body").addClass("no-announcement-bar");
});
}
});
</script>
{%- else -%}
<script>
$(document).ready(function() {
    if ($('.announcement-bar').length) {

        if (sessionStorage.getItem('barDismissed')) {
            $(".announcement-bar").remove();
            $("body").addClass("no-announcement-bar");
        } else {
            $('.x').click(function() {
                $(".announcement-bar").remove();
                $("body").addClass("no-announcement-bar");
              sessionStorage.setItem('barDismissed', true);
            });  
        }
    }
});
</script>
{%- endif -%}

{% schema %}
{
  "name": "Announcement bar",
  "settings": [
	{
	  "type": "header",
	  "content": "Behaviour"
	},
    {
      "type": "checkbox",
      "id": "show_announcement",
      "label": "Show announcement",
      "default": false
    },
	{
	  "type": "checkbox",
	  "id": "show_again",
	  "label": "Show again after close",
	  "default": false
	},
    {
      "type": "checkbox",
      "id": "home_page_only",
      "label": "Home page only",
      "default": true
    },
	{
	"type": "select",
        "id": "text_align",
        "label": "Text Alignment",
        "options": [
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "center",
              "label": "Center"
            },
            {
              "value": "right",
              "label": "Right"
            }
		],
      	"default": "center"
      },
    {
      "type": "color",
      "id": "announcement_bar_color",
      "label": "Background color",
      "default": "#000000"
    },
	{
	  "type": "header",
	  "content": "Close Button"
	},
	{
	  "type": "checkbox",
	  "id": "show_close_button",
	  "label": "Enable",
	  "default": true
	},
	{
	  "type": "color",
	  "id": "button_color",
	  "label": "Button Color",
	  "default": "#ffffff"
	},
	{
	  "type": "color",
	  "id": "button_bg_color",
	  "label": "Button Background Color",
	  "default": "#ffffff"
	},
	{
	  "type": "color",
	  "id": "hover_bg_color",
	  "label": "Background Color on Hover",
	  "default": "#000000"
	},
	{
	  "type": "range",
	  "id": "corner_radius",
	  "label": "Corner Radius",
	  "default": 0.0,
	  "unit": "em",
	  "min": 0,
	  "max": 2,
	  "step": 0.1
	},
	{
	  "type": "range",
	  "id": "button_x_width",
	  "label": "X Width",
	  "default": 20,
	  "unit": "px",
	  "min": 10,
	  "max": 70,
	  "step": 1
	},
	{
	  "type": "range",
	  "id": "button_bg_width",
	  "label": "Background Width",
	  "default": 30,
	  "unit": "px",
	  "min": 10,
	  "max": 80,
	  "step": 1
	},
	{
	  "type": "range",
	  "id": "button_bg_height",
	  "label": "Background Height",
	  "default": 30,
	  "unit": "px",
	  "min": 10,
	  "max": 80,
	  "step": 1
	},
	{
	  "type": "header",
	  "content": "Free Shipping Announement"
	},
	{
	  "type": "text",
	  "id": "free_shipping_threshold",
	  "label": "Free Shipping Threshold",
	  "default": "999"
	},
	{
	  "type": "textarea",
	  "id": "free_qualified",
	  "label": "Qualified Text",
      "default": "Your order qualifies for <strong>Free Shipping</strong>"
	},
	{
	  "type": "textarea",
	  "id": "free_not_qualified",
	  "label": "Not Qualified Text",
      "default": "Add <strong>[price]</strong> to get free shipping"
	},
	{
	  "type": "header",
	  "content": "Top Announcement"
	},
	{
	  "type": "checkbox",
	  "id": "top_shipping_count",
	  "label": "Enable Free Shipping Counter",
	  "default": false
	},
	{
      "type": "textarea",
      "id": "top_announce",
      "label": "Custom HTML"
	},
    {
      "type": "color",
      "id": "top_announce_color",
      "label": "Text color",
      "default": "#ffffff"
    },
	{
		"type": "range",
        "id": "top_announce_size",
        "min": 1,
        "max": 100,
        "step": 1,
        "unit": "px",
        "label": "Text Size",
        "default": 18
	},
	{
		"type": "range",
        "id": "top_announce_size_mobile",
        "min": 1,
        "max": 100,
        "step": 1,
        "unit": "px",
        "label": "Mobile Text Size",
        "default": 18
	},
	{
	"type": "range",
        "id": "top_announce_weight",
        "min": 100,
        "max": 900,
        "step": 100,
        "label": "Text Weight",
        "default": 400
	},
	{
	  "type": "header",
	  "content": "Bottom Announcement"
	},
	{
	  "type": "checkbox",
	  "id": "bottom_shipping_count",
	  "label": "Enable Free Shipping Counter",
	  "default": true
	},
	{
	  "type": "textarea",
	  "id": "bottom_announce",
	  "label": "Custom HTML"
	},
	{
      "type": "color",
      "id": "bottom_announce_color",
      "label": "Text color",
      "default": "#ffffff"
    },
	{
		"type": "range",
        "id": "bottom_announce_size",
        "min": 1,
        "max": 100,
        "step": 1,
        "unit": "px",
        "label": "Text Size",
        "default": 18
	},
	{
		"type": "range",
        "id": "bottom_announce_size_mobile",
        "min": 1,
        "max": 100,
        "step": 1,
        "unit": "px",
        "label": "Mobile Text Size",
        "default": 18
	},
	{
		"type": "range",
        "id": "bottom_announce_weight",
        "min": 100,
        "max": 900,
        "step": 100,
        "label": "Text Weight",
        "default": 400
	},
	{
	  "type": "header",
	  "content": "Footer Announcement"
	},
	{
	  "type": "checkbox",
	  "id": "footer_shipping_count",
	  "label": "Enable Free Shipping Counter",
	  "default": false
	},
	{
	  "type": "textarea",
	  "id": "footer_announce",
	  "label": "Custom HTML"
	},
	{
      "type": "color",
      "id": "footer_announce_color",
      "label": "Text color",
      "default": "#ffffff"    
	},
	{
		"type": "range",
        "id": "footer_announce_size",
        "min": 1,
        "max": 100,
        "step": 1,
        "unit": "px",
        "label": "Text Size",
        "default": 18
	},
	{
		"type": "range",
        "id": "footer_announce_size_mobile",
        "min": 1,
        "max": 100,
        "step": 1,
        "unit": "px",
        "label": "Mobile Text Size",
        "default": 18
	},
	{
		"type": "range",
        "id": "footer_announce_weight",
        "min": 100,
        "max": 900,
        "step": 100,
        "label": "Text Weight",
        "default": 400
	}
	]
	}

{% endschema %}
